## Core Node JS course work
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-4.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-5.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-6.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-7.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-8.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-9.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-10.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-11.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/Notebook-12.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/19.01.2018/Notebook-1.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/19.01.2018/Notebook-2.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/19.01.2018/Notebook-3.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/19.01.2018/Notebook-4.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/19.01.2018/Notebook-5.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-1.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-2.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-3.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-4.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-5.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-6.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-7.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-8.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-9.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-10.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/01/svg_files/22.01.2018/Notebook-11.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/05/svg_files/Notebook-22.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/05/svg_files/Notebook-23.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/05/svg_files/Notebook-24.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/05/svg_files/Notebook-25.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/05/svg_files/Notebook-26.svg" width="80%" height="80%">
</a>

## Global Objects, Process, and Buffer

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-27.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-28.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-29.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-30.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-37.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-38.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-39.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-40.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/06/svg_files/Notebook-42.svg" width="80%" height="80%">
</a>

```js

const { StringDecoder } = require('string_decoder');
const decoder = new StringDecoder('utf8');

process.stdn.on('readable', () => {
  const chunk = process.stdn.read();
  if (chunk != null ) {
    const buffer = Buffer.from([chunk]);
    console.log('with .toString function:', buffer.toString());
    console.log('With StringDecoder: function', decoder.write(buffer));
  }
});

```
## Require() function and 'stuff' about modules

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/07/svg_files/Notebook-43.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/07/svg_files/Notebook-44.svg" width="80%" height="80%">
</a>

```
$ node
> console.log(module);
{ id: 'repl',
  exports:
   { writer: { [Function: inspect] colors: [Object], styles: [Object] },
     _builtinLibs:
      [ 'assert',
        'buffer',
        'child_process',
        'cluster',
        'crypto',
        'dgram',
        'dns',
        'domain',
        'events',
        'fs',
        'http',
        'https',
        'net',
        'os',
        'path',
        'punycode',
        'querystring',
        'readline',
        'stream',
        'string_decoder',
        'tls',
        'tty',
        'url',
        'util',
        'vm',
        'zlib',
        'smalloc' ],
     REPLServer: { [Function: REPLServer] super_: [Object] },
     start: [Function],
     repl:
      { _domain: [Object],
        useGlobal: true,
        ignoreUndefined: false,
        rli: [Circular],
        eval: [Object],
        inputStream: [Object],
        outputStream: [Object],
        lines: [Object],
        context: [Object],
        _events: [Object],
        bufferedCommand: '',
        _sawReturn: true,
        domain: null,
        _maxListeners: undefined,
        output: [Object],
        input: [Object],
        completer: [Function: complete],
        _initialPrompt: '> ',
        _prompt: '> ',
        terminal: true,
        line: '',
        cursor: 0,
        history: [Object],
        historyIndex: -1,
        commands: [Object],
        writer: [Function],
        useColors: true,
        prevRows: 0 } },
  parent: undefined,
  filename: 'C:\\git\\NodeJS\\coreNode\\07\\repl',
  loaded: false,
  children: [],
  paths:
   [ 'C:\\git\\NodeJS\\coreNode\\07\\repl\\node_modules',
     'C:\\git\\NodeJS\\coreNode\\07\\node_modules',
     'C:\\git\\NodeJS\\coreNode\\node_modules',
     'C:\\git\\NodeJS\\node_modules',
     'C:\\git\\node_modules',
     'C:\\node_modules' ] }
undefined

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/07/svg_files/Notebook-45.svg" width="80%" height="80%">
</a>

## Addons

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/08/svg_files/Notebook-46.svg" width="80%" height="80%">
</a>

```javascript
require.extensions
{ '.js': [Function],
  '.json': [Function],
  '.node': [Function: dlopen] }

```

```cpp
// hello.cc edited by Stan Alam taken from https://nodejs.org/api/addons.html
#include <node.h>

namespace demo {

using v8::FunctionCallbackInfo;
using v8::Isolate;
using v8::Local;
using v8::Object;
using v8::String;
using v8::Value;

void Method(const FunctionCallbackInfo<Value>& args) {
  Isolate* isolate = args.GetIsolate();
  args.GetReturnValue().Set(String::NewFromUtf8(isolate, "Multiverse(s)"));
}

void init(Local<Object> exports) {
  NODE_SET_METHOD(exports, "hello", Method);
}

NODE_MODULE(NODE_GYP_MODULE_NAME, init)

}  // namespace demo
```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/08/svg_files/Notebook-47.svg" width="80%" height="80%">
</a>

```
> require.extensions['.json'].toString()
'function (module, filename) {\n  var content = fs.readFileSync(filename, \'utf8
\');\n  try {\n    module.exports = JSON.parse(stripBOM(content));\n  } catch (e
rr) {\n    err.message = filename + \': \' + err.message;\n    throw err;\n  }\n
}'
> require.extensions['.node'].toString()
'function dlopen() { [native code] }'
>

```
## Wrapping, Caching modules

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-48.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-49.svg" width="80%" height="80%">
</a>

```
> require('module').wrapper
[ '(function (exports, require, module, __filename, __dirname) { ',
  '\n});' ]
>

```

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-49.5.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-50.svg" width="80%" height="80%">
</a>

```javascript

const print = (stars, header) => {
  console.log('*'.repeat(stars));
  console.log(header);
  console.log('*'.repeat(stars));
};
// node >= 8
// or use harmony flag
```

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-51.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/09/svg_files/Notebook-52.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-53.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-54.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-62.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-63.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-64.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-65.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/svg_files/Notebook-66.svg" width="80%" height="80%">
</a>

# Concurrency Model and Event Loop

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/12/svg_files/Notebook-67.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/12/svg_files/Notebook-68.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/13-14/svg_files/Notebook-69.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/13-14/svg_files/Notebook-70.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/13-14/svg_files/Notebook-71.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-73.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-74.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-75.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-76.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-77.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-78.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-79.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-80.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-81.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-82.svg" width="80%" height="80%">
</a>

```js
const fs = require('fs');

fs.readFile(__filename, () => {
  setTimeout() => {
   console.log('execute timeout');
 }, 0); //set timeout is at 0 milliseconds
  setImmediate(() => {
    console.log('execute setImmediate');
  });
});
/*
$ node setImmediate.js
execute setImmediate
execute setTimeout
$
*/
```

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-83.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');

function fileSize (fileName, mycallBack) {
  if (typeof fileName !== 'string') {
    return mycallBack(new TypeError('argument should have been a string'));
  }

  fs.stat(fileName, (err, stats) => {
    if(err) {
      return mycallBack(err);
    }

    mycallBack(null, stats.size);
  });
}

fileSize(__filename, (err, size) => {
  if (err) throw err;

  console.log(`Size in KB: ${size/1024}`);
});

console.log('Hello, Multiverse!');

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-84.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-87.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-88.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');

const readFileAsArray = function(file, callback) {
    fs.readFile(file, function(err, data) {
        if (err) {
            return callback(error);
        }

        const lines = data.toString().trim().split('\n');
        callback(null, lines);
    });
};

readFileAsArray('./numbers', (err, lines) => {
    if (err) throw err;

    const numbers = lines.map(Number);
    const oddNumbers = numbers.filter(number => number % 2 === 1);
    console.log('odd number count is : ', oddNumbers.length);
});

```

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-91.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-92.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');

const readFileAsArray = function(file) {
  return new Promise((resolve, reject) => {
    fs.readFile(file, function(err, data) {
      if(err) {
        return reject(err);
      }

      const lines = data.toString().trim().split('\n');
      resolve(lines);
    });
  });
};

// here's where you make the call
readFileAsArray('./numbers').then(lines => {
  const numbers = lines.map(Number);
  const oddNumbers = numbers.filter(number => number % 2 === 1);
  console.log('odd numbers count:', oddNumbers.length);
})
.catch(console.error);

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-93.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-94.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-95.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');

const readFileAsArray = function(file, callback = () => {}) { //notice the empty function
  return new Promise((resolve, reject) => {
    fs.readFile(file, function(err, data) {
      if(err) {
        reject(err);
        return callback(err); // you can see you're still returning, this time with a callback
      }

      const lines = data.toString().trim().split('\n');
      resolve(lines);
      callback(null, lines);
    });
  });
};

// here's where you make the call
readFileAsArray('./numbers').then(lines => {
  const numbers = lines.map(Number);
  const oddNumbers = numbers.filter(number => number % 2 === 1);
  console.log('odd numbers count:', oddNumbers.length);
})
.catch(console.error);

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-96.svg" width="80%" height="80%">
</a>

```js

async function countEven() {
//  (%) is the modulus operator, it will let you have the remainder of place/sequence.length. taken from stackoverflow
try {
  const lines = await readFileAsArray('./numbers');
  const numbers = lines.map(Number);
  const evenCount = numbers.filter(number => number % 2 !== 1).length
  console.log('even number count is : ', evenCount);
} catch(err) {
  console.error(err);
}
  }
}

countEven(); // wow! async code running synchronously ... good for test automation!

```

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-98.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-99.svg" width="80%" height="80%">
</a>

```js
//sync_event.js
const EventEmitter = require('events');

class Logger extends EventEmitter {
  execute(theTask) {
    console.log('State before execution');
    this.emit('Begin');
    theTask();
    this.emit('fin');
    console.log('State after execution');
  }
}

const logger = new Logger();

logger.on('begin', () => console.log('About to execute'));
logger.on('end', () => console.log('Done with executing'));

logger.execute(() => console.log('***** execute task ******* '));

```
### Shell Output

```
$ node sync_event.js
State before execution
***** execute task *******
State after execution

```
**Notice that the execution of sync_event.js is synchronous.**

```js

//sync_event2.js
const EventEmitter = require('events');

class Logger extends EventEmitter {
  execute(theTask) {
    console.log('State before execution');
    this.emit('Begin');
    theTask();
    this.emit('fin');
    console.log('State after execution');
  }
}

const logger = new Logger();

logger.on('begin', () => console.log('About to execute'));
logger.on('end', () => console.log('Done with executing'));

logger.execute(() => setTimeout(
  () => console.log('***** execute task ******* '),
  1000
  )
);

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-100.svg" width="80%" height="80%">
</a>

```js
const fs = require('fs');
const EventEmitter = require('events');

class ElapsedTime extends EventEmitter {
execute(asyncFunc, ...args) {
  console.time('execute');
  this.emit('begin');
  asyncFunc(...args, (err, data) => {
    if(err) {
      return this.emit('error', err);
    }

    this.emit('data', data);
    console.timeEnd('execute');
    this.emit('end');
  });
  }
}

const elapsedTime = new ElapsedTime();

elapsedTime.on('begin', () => console.log('ready to exec'));
elapsedTime.on('end', () => console.log('completed execution'));

elapsedTime.execute(fs.readFile, __filename);

```
### Shell Output
```
$ node async_event.js
ready to exec
execute: 47.151ms
completed execution

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-101.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-102.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');
const EventEmitter = require('events');

class ElapsedTime extends EventEmitter {
execute(asyncFunc, ...args) {
  console.time('execute');
  this.emit('begin');
  asyncFunc(...args, (err, data) => {
    if(err) {
      return this.emit('error', err);
    }

    this.emit('data', data);
    console.timeEnd('execute');
    this.emit('end');
  });
  }
}

const elapsedTime = new ElapsedTime();

elapsedTime.on('data', (data) => {
  console.log(`Length: ${data.length}`);
});
elapsedTime.execute(fs.readFile, __filename);

```

### Shell Output

```
$ node async_event2.js
Length: 571
execute: 3.550ms

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-103.svg" width="80%" height="80%">
</a>

```js

const fs = require('fs');
const EventEmitter = require('events');

class ElapsedTime extends EventEmitter {
execute(asyncFunc, ...args) {
  console.time('execute');
  this.emit('begin');
  asyncFunc(...args, (err, data) => {
    if(err) {
      return this.emit('error', err);
    }

    this.emit('data', data);
    console.timeEnd('execute');
    this.emit('end');
  });
  }
}

const elapsedTime = new ElapsedTime();

elapsedTime.on('data', (data) => {
  console.log(`Length: ${data.length}`);
});

elapsedTime.execute(fs.readFile, ''); //notice blank in argument, will crash
elapsedTime.execute(fs.readFile, __filename);

```
<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-104.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-105.svg" width="80%" height="80%">
</a>

<a>
  <img src="https://github.com/stan-alam/NodeJS/blob/develop/coreNode/10/15-30/svg_files/Notebook-106.svg" width="80%" height="80%">
</a>

```javascript
const EventEmitter = require('events');

class Server extends EventEmitter {
  constructor(client) { //define the constructor to receive the client *within the server class
    super();  
  }
}
//created a function not just an object
module.exports = (client) => new Server(client); // Server(client) instantiate the server object with the client object
//the function (client) is going to receive the client

```

```javascript
//client
const EventEmitter = require('events');
const readline = require('readline');

const rl = readline.createInterface({
  input: process.stdin, output:process.stdout
});

//client event emmiter
const client = new EventEmitter(); //instantiate an object directly from EventEmitter
const server = require('./server')(client); //import server object
/* the client is going to emit events, while
the server is going to listen to those events
*/

rl.on('line', (input) => { //here register a listener for the line event, that receives an input

});

```

```js
//client with latest update to read input from cli and echo input with readline.process.stdout
const EventEmitter = require('events');
const readline = require('readline');

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

//client event emmiter
const client = new EventEmitter(); //instantiate an object directly from EventEmitter
const server = require('./server')(client); //import server object, also export a FUNCTION with the client as an arg
/* the client is going to emit events, while
the server is going to listen to those events
*/
//use the readline interInterface
rl.on('line', (input) => { //here register a listener for the line event, that receives an input
  console.log(input); //log the inpout line, to test the client
});

```

```
//output  
$ node client.js
yo
yo

```
